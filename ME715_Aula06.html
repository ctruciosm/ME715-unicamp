<!DOCTYPE html>
<html lang="en"><head>
<script src="ME715_Aula06_files/libs/clipboard/clipboard.min.js"></script>
<script src="ME715_Aula06_files/libs/quarto-html/tabby.min.js"></script>
<script src="ME715_Aula06_files/libs/quarto-html/popper.min.js"></script>
<script src="ME715_Aula06_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="ME715_Aula06_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ME715_Aula06_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="ME715_Aula06_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.2.269">

  <meta name="author" content="Prof.&nbsp;Carlos Trucíos  ctrucios@unicamp.br">
  <title>ME715 - Econometria</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="ME715_Aula06_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="ME715_Aula06_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="ME715_Aula06_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="ME715_Aula06_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="ME715_Aula06_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="ME715_Aula06_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="ME715_Aula06_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="ME715_Aula06_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="ME715_Aula06_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="imagens/unicamp.png" data-background-opacity="1" data-background-position="99% 5%" data-background-size="20%" class="quarto-title-block center">
  <h1 class="title">ME715 - Econometria</h1>
  <p class="subtitle">Heterocedasticidade e erros autocorrelacionados</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Prof.&nbsp;Carlos Trucíos <br> ctrucios@unicamp.br 
</div>
        <p class="quarto-title-affiliation">
            Instituto de Matemática, Estatística e Computação Científica (IMECC), <br> Universidade Estadual de Campinas (UNICAMP).
          </p>
    </div>
</div>

</section>
<section>
<section id="heterocedasticidade" class="title-slide slide level1 center">
<h1>Heterocedasticidade</h1>

</section>
<section id="introdução" class="slide level2">
<h2>Introdução</h2>
<ul>
<li class="fragment"><p>Até agora, temos assumido que HRLM5 acontece, ou seja <span class="math inline">\(\mathbb{V}(u|\textbf{X}) = \sigma^2 \textbf{I}\)</span></p></li>
<li class="fragment"><p>Mas, o que acontece se esta hipótese não se verifica?</p></li>
<li class="fragment"><p>Suponha que em geral, temos: <span class="math display">\[\mathbb{V}(u|\textbf{X}) = \begin{bmatrix}
\sigma^2_1 &amp; 0 &amp; 0 &amp;\cdots &amp; 0\\
0 &amp; \sigma^2_2 &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \cdots &amp; \ddots &amp; \cdots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \cdots &amp; \sigma^2_n \\
\end{bmatrix} = \sigma^2 \Omega \]</span></p></li>
</ul>
</section></section>
<section>
<section id="consequências" class="title-slide slide level1 center">
<h1>Consequências</h1>

</section>
<section id="consequências-1" class="slide level2">
<h2>Consequências</h2>
<p>Seja <span class="math display">\[Y = X \beta + u, \quad com \quad \mathbb{E}(u|X) = 0 \quad e \quad \mathbb{V}(u|X) = \sigma^2 \Omega.\]</span></p>
<ul>
<li class="fragment"><span class="math inline">\(\hat{\beta}\)</span> continua sendo não viesado?.</li>
<li class="fragment"><span class="math inline">\(\mathbb{V}(\hat{\beta}|X) = \sigma^2(X'X)^{-1}\)</span>?.</li>
</ul>
<div class="fragment">
<blockquote>
<p>Na presença de heterocedasticidade, <span class="math inline">\(\hat{\beta}_{MQO}\)</span> ainda são não viesados, mas <span class="math inline">\(\mathbb{V}(\hat{\beta}|X) = \sigma^2(X'X)^{-1}X'\Omega X(X'X)^{-1}\)</span>, ou seja, para podermos fazer inferência, precisamos estimar <span class="math inline">\(\mathbb{V}(\hat{\beta}|X)\)</span> corretamente.</p>
</blockquote>
</div>
</section></section>
<section>
<section id="estimador-de-white" class="title-slide slide level1 center">
<h1>Estimador de White</h1>

</section>
<section id="estimador-de-white-1" class="slide level2">
<h2>Estimador de White</h2>
<ul>
<li class="fragment"><span class="math inline">\(\sigma^2 \Omega\)</span> contém <span class="math inline">\(n\)</span> parametros. Assim, no total temos <span class="math inline">\(n + k + 1\)</span> parâmetros a serem estimados.</li>
<li class="fragment">Temos apenas <span class="math inline">\(n\)</span> observações. Isto torna o problema impossível de ser resolvido.</li>
<li class="fragment"><a href="https://www.jstor.org/stable/1912934">White (1980)</a> mostrou que não precisamos estimar <span class="math inline">\(\sigma^2 \Omega\)</span>. De fato, podemos resolver o problema estimando <span class="math inline">\(X'\sigma^2 \Omega X\)</span> (que tem dimensão bem menor).</li>
<li class="fragment">Note que, <span class="math inline">\(X'\sigma^2 \Omega X = \displaystyle \sum_{i = 1}^n \sigma_i^2 x_i x_i'\)</span></li>
<li class="fragment">O estimador de White substitui <span class="math inline">\(\sigma_i^2\)</span> com <span class="math inline">\(\hat{u}^2_i\)</span> (<span class="math inline">\(i = 1, \cdots, n\)</span>), em que <span class="math inline">\(\hat{u}_i = y_i - x_i' \hat{\beta}_{MQO}\)</span> como usual.</li>
<li class="fragment">Com esta correção, teremos testes t, F e qualquer teste da forma <span class="math inline">\(H_0: R\beta = r\)</span> <strong>assintóticamente</strong> validos.</li>
</ul>
</section>
<section id="estimador-de-white-2" class="slide level2">
<h2>Estimador de White</h2>
<ul>
<li class="fragment">O estimador de White funciona bem quando <span class="math inline">\(n \rightarrow \infty\)</span>.</li>
<li class="fragment">Pode não funcionar muito bem quando <span class="math inline">\(n\)</span> é pequeno.</li>
<li class="fragment">Em amostras pequenas, utilizar <span class="math inline">\(n\hat{u}_i^2/(n - k - 1)\)</span> ou <span class="math inline">\(\hat{u}_i^2/(1-h_i)\)</span> em lugar de <span class="math inline">\(\hat{u}_i^2\)</span> (<span class="math inline">\(h_i = x_i'(X'X)^{-1}x_i\)</span>) melhora o desempenho do estimador.</li>
</ul>
</section>
<section id="estimador-de-white-3" class="slide level2">
<h2>Estimador de White</h2>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">R</a></li><li><a href="#tabset-1-2">Python</a></li><li><a href="#tabset-1-3">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(wooldridge)</span>
<span id="cb1-2"><a href="#cb1-2"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(wage) <span class="sc">~</span> married <span class="sc">*</span> female <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> tenure <span class="sc">+</span> <span class="fu">I</span>(tenure<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>wage1)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">summary</span>(modelo)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    Estimate   Std. Error   t value     Pr(&gt;|t|)
(Intercept)     0.3213780953 0.1000089907  3.213492 1.393116e-03
married         0.2126756752 0.0553571777  3.841881 1.372701e-04
female         -0.1103502102 0.0557420525 -1.979658 4.827187e-02
educ            0.0789102812 0.0066944982 11.787333 1.434377e-28
exper           0.0268005690 0.0052428473  5.111835 4.499248e-07
I(exper^2)     -0.0005352452 0.0001104258 -4.847105 1.659161e-06
tenure          0.0290875220 0.0067620027  4.301613 2.027894e-05
I(tenure^2)    -0.0005331425 0.0002312429 -2.305552 2.153060e-02
married:female -0.3005930681 0.0717669496 -4.188461 3.302085e-05</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Estimador de White</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">library</span>(car) <span class="co"># Contém a função para o estimador de White</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>white_estimator <span class="ot">&lt;-</span> <span class="fu">hccm</span>(modelo, <span class="at">type =</span> <span class="st">"hc0"</span>) </span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="do">## hco: White clássico, </span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="do">## hc1: correção para pequenas amostras</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(white_estimator)), <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept)        married         female           educ          exper 
    0.10852842     0.05665095     0.05662551     0.00735096     0.00509497 
    I(exper^2)         tenure    I(tenure^2) married:female 
    0.00010543     0.00688128     0.00024159     0.07174996 </code></pre>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">import</span> wooldridge <span class="im">as</span> woo</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a>wage1 <span class="op">=</span> woo.dataWoo(<span class="st">'wage1'</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a>modelo <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">'np.log(wage) ~ married*female + educ + exper + I(exper**2) + tenure + I(tenure**2)'</span>, data <span class="op">=</span> wage1)</span>
<span id="cb5-8"><a href="#cb5-8"></a>results <span class="op">=</span> modelo.fit()</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a>table <span class="op">=</span> pd.DataFrame({<span class="st">'b'</span>: <span class="bu">round</span>(results.params, <span class="dv">4</span>), <span class="st">'se'</span>: <span class="bu">round</span>(results.bse, <span class="dv">4</span>)})</span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="bu">print</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     b      se
Intercept       0.3214  0.1000
married         0.2127  0.0554
female         -0.1104  0.0557
married:female -0.3006  0.0718
educ            0.0789  0.0067
exper           0.0268  0.0052
I(exper ** 2)  -0.0005  0.0001
tenure          0.0291  0.0068
I(tenure ** 2) -0.0005  0.0002</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>results_white <span class="op">=</span> modelo.fit(cov_type <span class="op">=</span> <span class="st">'HC0'</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>table_white <span class="op">=</span> pd.DataFrame({<span class="st">'b'</span>: <span class="bu">round</span>(results_white.params, <span class="dv">4</span>), <span class="st">'se'</span>: <span class="bu">round</span>(results_white.bse, <span class="dv">4</span>)})</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="bu">print</span>(table_white)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     b      se
Intercept       0.3214  0.1085
married         0.2127  0.0567
female         -0.1104  0.0566
married:female -0.3006  0.0717
educ            0.0789  0.0074
exper           0.0268  0.0051
I(exper ** 2)  -0.0005  0.0001
tenure          0.0291  0.0069
I(tenure ** 2) -0.0005  0.0002</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3">
<p>Não existe um função pronta em Julia. Opções:</p>
<ol type="a">
<li class="fragment">Implementar nossa propria função (ver lista de exercícios).</li>
<li class="fragment">Chamar funções do R ou do Python para funcionarem em Julia (mas precisa configurar corretamente o ambiente para isso).</li>
</ol>
</div>
</div>
</div>
</section>
<section id="estimador-de-white-4" class="slide level2">
<h2>Estimador de White</h2>
<ul>
<li class="fragment">No exemplo anterior, os valores estimados do desvio padrão são muito próximos.</li>
<li class="fragment">Muito provavelmente, teremos que no exemplo a hipótese de homocedasticidade não pode ser rejeitada.</li>
<li class="fragment">O estimador de White funciona também quando temos homocedasticidade.</li>
<li class="fragment">Se White também funciona sob homocedasticidade, por que não usar diretamente este estimador?</li>
<li class="fragment">O estimador de White tem um bom desempenho quando <span class="math inline">\(n \rightarrow \infty\)</span>. Em amostras pequenas (mesmo depois da correção), se todas as outras hipóteses forem satisfeitas, é melhor utilizar a versão padrão de <span class="math inline">\(\widehat{\mathbb{V}}(\hat{\beta}|X)\)</span>.</li>
<li class="fragment">Em amostras grandes, podemos sim utilizar diretamente White.</li>
</ul>
</section></section>
<section>
<section id="testes-para-detetar-heterocedasticidade" class="title-slide slide level1 center">
<h1>Testes para detetar heterocedasticidade</h1>

</section>
<section id="testes-para-detetar-heterocedasticidade-1" class="slide level2">
<h2>Testes para detetar heterocedasticidade</h2>
<ul>
<li class="fragment">Sob HRML4, <span class="math inline">\(\mathbb{E}(u|\textbf{X}) = 0\)</span>.</li>
<li class="fragment">Isto implica que, <span class="math inline">\(\mathbb{V}(u|\textbf{X}) = \mathbb{E}(u^2|\textbf{X})\)</span>.</li>
<li class="fragment">Assim, homocedasticidade equivale a <span class="math inline">\(\mathbb{E}(u^2|\textbf{X}) = \sigma^2I\)</span>.</li>
<li class="fragment">Assim, para verificar homocedasticidade, podemos verificar se <span class="math inline">\(u^2\)</span> está relacionado a uma ou mais variáveis explicativas. Por exemplo, ajustar a regressão <span class="math inline">\(u^2 = \delta_0 + \delta_1 x_1 + \cdots + \delta_k x_k + \nu\)</span> e verificar se <span class="math inline">\(H_0: \delta_1 = \delta_2 = \cdots = \delta_k = 0\)</span>.</li>
<li class="fragment">Nunca conhecemos <span class="math inline">\(u_i\)</span>, mas temos estimativas dele (<span class="math inline">\(\hat{u}_i\)</span>). Assim, podemos testar homocedasticidade verificando se <span class="math inline">\(\hat{u}^2\)</span> está relacionado a uma ou mais variáveis explicativas</li>
</ul>
</section>
<section id="testes-para-detetar-heterocedasticidade-2" class="slide level2">
<h2>Testes para detetar heterocedasticidade</h2>
<h3 id="teste-de-white">Teste de White</h3>
<p>O procedimento consiste em fazer uma regressão auxiliar de <span class="math inline">\(\hat{u}^2\)</span> sob todas as variaveis, seus quadrados e produtos cruzados.</p>
<div class="fragment">
<p>Sob <span class="math inline">\(H_0\)</span> (homocedasticidade), <span class="math display">\[nR^2 \sim \chi^2_q,\]</span> em que <span class="math inline">\(q\)</span> é o número de variáveis no modelo auxiliar.</p>
</div>
<div class="fragment">
<p><span style="color:red;">Se rejeitamos <span class="math inline">\(H_0\)</span>, temos evidência de heterocedasticidade (mas não sabemos a forma que tem).</span></p>
</div>
<div class="fragment">
<blockquote>
<p>Uma outra desvantagem do teste é que se no modelo <span class="math inline">\(k\)</span> for grande, no modelo auxiliar q = k(k+1)/2 - 1. Esse número elevado torna o teste com pouco poder (rejeitar <span class="math inline">\(H_0\)</span> quando <span class="math inline">\(H_0\)</span> é falso). Uma alternativa é regredir <span class="math inline">\(\hat{u}^2\)</span> sob <span class="math inline">\(\hat{y}\)</span> e <span class="math inline">\(\hat{y}^2\)</span>.</p>
</blockquote>
</div>
</section>
<section id="testes-para-detetar-heterocedasticidade-3" class="slide level2">
<h2>Testes para detetar heterocedasticidade</h2>
<h3 id="teste-de-white-1">Teste de White</h3>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">R</a></li><li><a href="#tabset-2-2">Python</a></li><li><a href="#tabset-2-3">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">library</span>(wooldridge)</span>
<span id="cb9-3"><a href="#cb9-3"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(wage) <span class="sc">~</span> married <span class="sc">*</span> female <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> tenure <span class="sc">+</span> <span class="fu">I</span>(tenure<span class="sc">^</span><span class="dv">2</span>), <span class="at">data=</span>wage1)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="fu">bptest</span>(modelo, <span class="sc">~</span> <span class="fu">fitted</span>(modelo) <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">fitted</span>(modelo)<span class="sc">^</span><span class="dv">2</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo
BP = 4.1558, df = 2, p-value = 0.1252</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="im">import</span> wooldridge <span class="im">as</span> woo</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a>wage1 <span class="op">=</span> woo.dataWoo(<span class="st">'wage1'</span>)</span>
<span id="cb11-8"><a href="#cb11-8"></a>modelo <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">'np.log(wage) ~ married*female + educ + exper + I(exper**2) + tenure + I(tenure**2)'</span>, data <span class="op">=</span> wage1)</span>
<span id="cb11-9"><a href="#cb11-9"></a>results <span class="op">=</span> modelo.fit()</span>
<span id="cb11-10"><a href="#cb11-10"></a></span>
<span id="cb11-11"><a href="#cb11-11"></a>X_wh <span class="op">=</span> pd.DataFrame({<span class="st">'const'</span>: <span class="dv">1</span>, </span>
<span id="cb11-12"><a href="#cb11-12"></a>                     <span class="st">'fitted_reg'</span>: results.fittedvalues,</span>
<span id="cb11-13"><a href="#cb11-13"></a>                     <span class="st">'fitted_reg_sq'</span>: results.fittedvalues<span class="op">**</span><span class="dv">2</span>}) </span>
<span id="cb11-14"><a href="#cb11-14"></a>result_white <span class="op">=</span> sm.stats.diagnostic.het_breuschpagan(results.resid, X_wh)</span>
<span id="cb11-15"><a href="#cb11-15"></a>result_white[<span class="dv">1</span>] <span class="co"># pvalor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.12519488113966223</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">using</span> <span class="bu">WooldridgeDatasets</span>, <span class="bu">GLM</span>, <span class="bu">DataFrames</span>, <span class="bu">HypothesisTests</span></span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>wage1 <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">wooldridge</span>(<span class="st">"wage1"</span>));</span>
<span id="cb13-4"><a href="#cb13-4"></a>modelo <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(<span class="fu">log</span>(wage) <span class="op">~</span> married <span class="op">*</span> female <span class="op">+</span> educ <span class="op">+</span> exper <span class="op">+</span> (exper<span class="op">^</span><span class="fl">2</span>) <span class="op">+</span> tenure <span class="op">+</span> (tenure<span class="op">^</span><span class="fl">2</span>)), wage1);</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a>X_wh <span class="op">=</span> <span class="fu">hcat</span>(<span class="fu">ones</span>(<span class="fu">size</span>(wage1)[<span class="fl">1</span>]), <span class="fu">predict</span>(modelo), <span class="fu">predict</span>(modelo)<span class="op">.^</span> <span class="fl">2</span>);</span>
<span id="cb13-7"><a href="#cb13-7"></a>result_white <span class="op">=</span> <span class="fu">WhiteTest</span>(X_wh, <span class="fu">residuals</span>(modelo), <span class="kw">type</span><span class="op">=:</span>linear);</span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="fu">pvalue</span>(result_white)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.12519488113965127</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="testes-para-detetar-heterocedasticidade-4" class="slide level2">
<h2>Testes para detetar heterocedasticidade</h2>
<h3 id="teste-de-breusch-pagangodfrey">Teste de Breusch-Pagan/Godfrey</h3>
<p>Seja o modelo <span class="math display">\[Y = X\beta + u, \quad com \quad \mathbb{E}(u|X) = 0 \quad e \quad \mathbb{V}(u_i) = \sigma_i^2 = h(z_i'\alpha),\]</span> em que:</p>
<div class="{non-incremental}">
<ul>
<li class="fragment"><span class="math inline">\(z_i' = [1, z_{i1}, \cdots, z_{pi}]\)</span> é um vetor de variáveis</li>
<li class="fragment"><span class="math inline">\(\alpha = [\alpha_1, \alpha_2, \cdots, \alpha_p]\)</span> é um vetor de coeficientes desconhecidos e</li>
<li class="fragment"><span class="math inline">\(h(\cdot): \mathbb{R} \rightarrow \mathbb{R}^{+}\)</span></li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[H_0: \alpha_2 = \cdots = \alpha_p = 0 \quad (homocedasticidade)\]</span></p>
</div>
<div class="fragment">
<p>Sob <span class="math inline">\(H_0\)</span>, <span class="math inline">\(\sigma_i^2 = h(\alpha_1), \forall i\)</span> (ou seja, homocedasticidade)</p>
</div>
</section>
<section id="testes-para-detetar-heterocedasticidade-5" class="slide level2">
<h2>Testes para detetar heterocedasticidade</h2>
<h3 id="teste-de-breusch-pagangodfrey-1">Teste de Breusch-Pagan/Godfrey</h3>
<p>O procedimento funciona da seguinte forma:</p>
<ol type="1">
<li class="fragment">Estimar o modelo original por MQO e obter <span class="math inline">\(\hat{u}_i = y_i - \hat{y}_i\)</span> e <span class="math inline">\(\tilde{\sigma}^2 = \displaystyle \sum_{i = 1}^n \hat{u}_i^2/n\)</span>.</li>
<li class="fragment">Regredir <span class="math inline">\(\hat{u}_i^2/\tilde{\sigma}^2\)</span> sob <span class="math inline">\(z\)</span> por MQO e calcular a soma de quadrado explicada (SQE).</li>
<li class="fragment">Sob <span class="math inline">\(H_0\)</span>, <span class="math inline">\(0.5 SQE \sim \chi^2_{p-1}\)</span></li>
</ol>
</section>
<section id="testes-para-detetar-heterocedasticidade-6" class="slide level2">
<h2>Testes para detetar heterocedasticidade</h2>
<h3 id="teste-de-breusch-pagangodfrey-2">Teste de Breusch-Pagan/Godfrey</h3>
<ul>
<li class="fragment">Um teste assintóticamente equivalente consiste em regredir <span class="math inline">\(\hat{u}_i^2\)</span> sob <span class="math inline">\(z\)</span>. Nesse caso, <span class="math inline">\(nR^2 \sim \chi_{p-1}^2\)</span>.</li>
<li class="fragment">O teste requer as variáveis <span class="math inline">\(z\)</span> que podem causar a heterocedasticidade sejam conhecidas</li>
<li class="fragment">Na prática essas variáveis não são conhecidas e usualmente utilizamos algumas (ou todas) das variáveis em <span class="math inline">\(x\)</span>. Isto faz com que o teste seja basicamente um caso particular do teste de White.</li>
</ul>
</section>
<section id="testes-para-detetar-heterocedasticidade-7" class="slide level2">
<h2>Testes para detetar heterocedasticidade</h2>
<h3 id="teste-de-breusch-pagangodfrey-3">Teste de Breusch-Pagan/Godfrey</h3>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">R</a></li><li><a href="#tabset-3-2">Python</a></li><li><a href="#tabset-3-3">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="fu">library</span>(wooldridge)</span>
<span id="cb15-3"><a href="#cb15-3"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(wage) <span class="sc">~</span> married <span class="sc">*</span> female <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> tenure <span class="sc">+</span> <span class="fu">I</span>(tenure<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> wage1)</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="fu">bptest</span>(modelo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo
BP = 13.189, df = 8, p-value = 0.1055</code></pre>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="im">import</span> wooldridge <span class="im">as</span> woo</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="im">import</span> patsy <span class="im">as</span> pt</span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a>wage1 <span class="op">=</span> woo.dataWoo(<span class="st">'wage1'</span>)</span>
<span id="cb17-9"><a href="#cb17-9"></a>modelo <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">'np.log(wage) ~ married*female + educ + exper + I(exper**2) + tenure + I(tenure**2)'</span>, data <span class="op">=</span> wage1)</span>
<span id="cb17-10"><a href="#cb17-10"></a>results <span class="op">=</span> modelo.fit()</span>
<span id="cb17-11"><a href="#cb17-11"></a></span>
<span id="cb17-12"><a href="#cb17-12"></a>y, X_bp <span class="op">=</span> pt.dmatrices(<span class="st">'np.log(wage) ~ married*female + educ + exper + I(exper**2) + tenure + I(tenure**2)'</span>, data <span class="op">=</span> wage1, return_type <span class="op">=</span> <span class="st">'dataframe'</span>)</span>
<span id="cb17-13"><a href="#cb17-13"></a></span>
<span id="cb17-14"><a href="#cb17-14"></a>result_bp <span class="op">=</span> sm.stats.diagnostic.het_breuschpagan(results.resid, X_bp)</span>
<span id="cb17-15"><a href="#cb17-15"></a>result_bp[<span class="dv">1</span>] <span class="co"># pvalor</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.10549994226505134</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>X_bp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Intercept  married  female  ...  I(exper ** 2)  tenure  I(tenure ** 2)
0          1.0      0.0     1.0  ...            4.0     0.0             0.0
1          1.0      1.0     1.0  ...          484.0     2.0             4.0
2          1.0      0.0     0.0  ...            4.0     0.0             0.0
3          1.0      1.0     0.0  ...         1936.0    28.0           784.0
4          1.0      1.0     0.0  ...           49.0     2.0             4.0
..         ...      ...     ...  ...            ...     ...             ...
521        1.0      1.0     1.0  ...          196.0     2.0             4.0
522        1.0      0.0     1.0  ...            4.0     0.0             0.0
523        1.0      1.0     0.0  ...          169.0    18.0           324.0
524        1.0      1.0     0.0  ...           25.0     1.0             1.0
525        1.0      0.0     1.0  ...           25.0     4.0            16.0

[526 rows x 9 columns]</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1"></a><span class="im">using</span> <span class="bu">WooldridgeDatasets</span>, <span class="bu">GLM</span>, <span class="bu">DataFrames</span>, <span class="bu">HypothesisTests</span>, <span class="bu">StatsModels</span></span>
<span id="cb21-2"><a href="#cb21-2"></a></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="kw">function</span> <span class="fu">getMats</span>(formula, df)</span>
<span id="cb21-4"><a href="#cb21-4"></a>  f <span class="op">=</span> <span class="fu">apply_schema</span>(formula, <span class="fu">schema</span>(formula, df)) </span>
<span id="cb21-5"><a href="#cb21-5"></a>  resp, pred <span class="op">=</span> <span class="fu">modelcols</span>(f, df)</span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="cf">return</span> (resp, pred)</span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>getMats (generic function with 1 method)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1"></a></span>
<span id="cb23-2"><a href="#cb23-2"></a>wage1 <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">wooldridge</span>(<span class="st">"wage1"</span>));</span>
<span id="cb23-3"><a href="#cb23-3"></a>f <span class="op">=</span> <span class="pp">@formula</span>(<span class="fu">log</span>(wage) <span class="op">~</span> married <span class="op">*</span> female <span class="op">+</span> educ <span class="op">+</span> exper <span class="op">+</span> (exper<span class="op">^</span><span class="fl">2</span>) <span class="op">+</span> tenure <span class="op">+</span> (tenure<span class="op">^</span><span class="fl">2</span>));</span>
<span id="cb23-4"><a href="#cb23-4"></a>modelo <span class="op">=</span> <span class="fu">lm</span>(f, wage1);</span>
<span id="cb23-5"><a href="#cb23-5"></a></span>
<span id="cb23-6"><a href="#cb23-6"></a>X_bp <span class="op">=</span>  <span class="fu">hcat</span>(<span class="fu">ones</span>(<span class="fu">size</span>(wage1)[<span class="fl">1</span>]), <span class="fu">getMats</span>(f, wage1)[<span class="fl">2</span>]);</span>
<span id="cb23-7"><a href="#cb23-7"></a></span>
<span id="cb23-8"><a href="#cb23-8"></a>result_bp <span class="op">=</span> <span class="fu">WhiteTest</span>(X_bp, <span class="fu">residuals</span>(modelo), <span class="kw">type</span><span class="op">=:</span>linear);</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="fu">pvalue</span>(result_bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.10549994226505131</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="testes-para-detetar-heterocedasticidade-8" class="slide level2">
<h2>Testes para detetar heterocedasticidade</h2>
<h3 id="teste-de-goldfeld-quandt">Teste de Goldfeld-Quandt</h3>
<p>Teste simples que pode ser aplicado quando apenas uma variável é quem causa a heterocedasticidade. Para ilustrar o procedimento, imagine que <span class="math inline">\(\sigma_i^2\)</span> esteja positivamente correlacionado com <span class="math inline">\(X_k\)</span>. O teste funciona da seguinte forma:</p>
<ol type="1">
<li class="fragment">Reordenar as observações pelo valor de <span class="math inline">\(x_k\)</span>.</li>
<li class="fragment">Omitir as <span class="math inline">\(c\)</span> observações centrais.</li>
<li class="fragment">Ajustar dois modelos de regressão por MQO (cada um com <span class="math inline">\((n - c)/2\)</span> observações).</li>
<li class="fragment">Calcular a Soma de Quadrados dos Residuos em ambas as regressões e então calcular <span class="math inline">\(R = \dfrac{SQR_2}{SQR_1}\)</span>.</li>
<li class="fragment">Sob <span class="math inline">\(H_0\)</span>, <span class="math inline">\(R \sim F_{(n - c - 2(k+1))/2, (n - c - 2(k+1))/2}\)</span></li>
</ol>
<div class="fragment">
<blockquote>
<p>O poder do teste depende do valor <span class="math inline">\(c\)</span>. Um valor usual é <span class="math inline">\(c = n/3\)</span></p>
</blockquote>
</div>
</section>
<section id="testes-para-detetar-heterocedasticidade-9" class="slide level2">
<h2>Testes para detetar heterocedasticidade</h2>
<h3 id="teste-de-goldfeld-quandt-1">Teste de Goldfeld-Quandt</h3>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">library</span>(wooldridge)</span>
<span id="cb25-3"><a href="#cb25-3"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(wage) <span class="sc">~</span> married <span class="sc">*</span> female <span class="sc">+</span> educ <span class="sc">+</span> exper <span class="sc">+</span> <span class="fu">I</span>(exper<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> tenure <span class="sc">+</span> <span class="fu">I</span>(tenure<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> wage1)</span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="fu">gqtest</span>(modelo, <span class="at">point =</span> <span class="fl">0.5</span>, <span class="at">fraction =</span> <span class="dv">100</span>,</span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">order.by =</span> wage1<span class="sc">$</span>educ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Goldfeld-Quandt test

data:  modelo
GQ = 1.0399, df1 = 204, df2 = 204, p-value = 0.78
alternative hypothesis: variance changes from segment 1 to 2</code></pre>
</div>
</div>
</section></section>
<section>
<section id="erros-correlacionados" class="title-slide slide level1 center">
<h1>Erros correlacionados</h1>

</section>
<section id="introdução-1" class="slide level2">
<h2>Introdução</h2>
<ul>
<li class="fragment">Até agora, temos assumido que os erros são não correlacionados.</li>
<li class="fragment">Mas, o que acontece se <span class="math inline">\(\mathbb{E}(u_t, u_{t+s}) \neq 0\)</span> para <span class="math inline">\(s \neq 0\)</span>?</li>
<li class="fragment">Lembre-se que <span class="math inline">\(\rho_s = \dfrac{\mathbb{C}ov(u_t, u_{t+2})}{\sqrt{\mathbb{V}(u_t) \times \mathbb{V}(u_{t+s})}}\)</span>. - Assim, sob homocedasticidade, <span class="math inline">\(\rho_s = \dfrac{\mathbb{E}(u_t, u_{t+s})}{\sigma_u^2}\)</span></li>
</ul>
</section>
<section id="introdução-2" class="slide level2">
<h2>Introdução</h2>
<p><span class="math display">\[\mathbb{V}(u|\textbf{X}) = \sigma^2_u \begin{bmatrix}
1 &amp; \rho_1 &amp; \rho_2 &amp;\cdots &amp; \rho_{n-1} \\
\rho_1 &amp; 1 &amp; \rho_1 &amp; \cdots &amp; \rho_{n-2} \\
\vdots &amp; \cdots &amp; \ddots &amp; \cdots &amp; \vdots \\
\rho_{n-1} &amp; \rho_{n-2} &amp; \rho_{n-3} &amp; \cdots &amp; 1 \\
\end{bmatrix}\]</span></p>
<p><span style="color:red;">Sem nenhuma informação adicional, este problema de estimação é intratável pois temos <span class="math inline">\(n + k + 1\)</span> parâmetros e apenas <span class="math inline">\(n\)</span> observações.</span></p>
<div class="fragment">
<p>Para poder abordar o problema, precisamos assumir alguma estrutura na autocorrelação.</p>
</div>
</section></section>
<section>
<section id="erros-ar1" class="title-slide slide level1 center">
<h1>Erros AR(1)</h1>

</section>
<section id="erros-ar1-1" class="slide level2">
<h2>Erros AR(1)</h2>
<p>Uma das especificações mais communs é o AR(1) <a href="https://ctruciosm.github.io/ME607-unicamp/Aula01.html#/conceitos-b%C3%A1sicos-4">estacionário</a>, ou seja, <span class="math display">\[u_t = \phi u_{t-1} + \epsilon_t, \quad  \epsilon_t \sim WN(0, \sigma_e^2), \quad com \quad |\phi| &lt; 1.\]</span></p>
<ul>
<li class="fragment"><span class="math inline">\(\mathbb{E}(u_t) = 0\)</span>, <span class="math inline">\(\mathbb{V}(u_t) = \dfrac{\sigma_e^2}{1-\phi^2}\)</span> e <span class="math inline">\(\rho_s = E(u_t u_{t+s}) = \phi^s\)</span></li>
</ul>
<div class="fragment">
<p>Assim, <span class="math display">\[\mathbb{V}(u|\textbf{X}) = \sigma^2_u \begin{bmatrix}
1 &amp; \phi &amp; \phi^2 &amp;\cdots &amp; \phi^{n-1} \\
\phi &amp; 1 &amp; \phi &amp; \cdots &amp; \phi^{n-2} \\
\vdots &amp; \cdots &amp; \ddots &amp; \cdots &amp; \vdots \\
\phi^{n-1} &amp; \phi^{n-2} &amp; \phi^{n-3} &amp; \cdots &amp; 1 \\
\end{bmatrix}\]</span></p>
</div>
<div class="fragment">
<blockquote>
<p>Agora temos apenas <span class="math inline">\(k + 3\)</span> parâmetros a serem estimados.</p>
</blockquote>
</div>
</section>
<section id="além-dos-erros-ar1" class="slide level2">
<h2>Além dos erros AR(1)</h2>
<p>Assim como no caso dos erros AR(1), poderiamos pensar em erros MA(1). Neste caso <span class="math display">\[u_t = \epsilon_t + \theta \epsilon_{t-1}, \quad com \quad \epsilon_t \sim WN(0, \sigma_e^2).\]</span></p>
<ul>
<li class="fragment"><span class="math inline">\(\mathbb{E}(u_t) = 0\)</span>, <span class="math inline">\(\mathbb{V}(u_t) = \dfrac{\sigma_e^2}{1+\theta^2}\)</span> <span class="math inline">\(\rho_1 = \dfrac{\theta}{1 + \theta^2}\)</span> e <span class="math inline">\(\rho_i = 0, \forall i&gt;1\)</span></li>
</ul>
<div class="fragment">
<blockquote>
<p>Em geral, poderiamos assumir qualquer ARMA(p,q) mas em geral AR(1) ou MA(1) costumam ser suficientes na maioria dos casos.</p>
</blockquote>
</div>
</section>
<section id="o-que-pode-gerar-erros-autocorrelacionados" class="slide level2">
<h2>O que pode gerar erros autocorrelacionados?</h2>
<p>Seja o modelo <span class="math display">\[Y = X\beta + u.\]</span></p>
<ul>
<li class="fragment">Esperamos que todas as variáveis relevantes para explicar Y tenham sido incluidas no modelo. Nesses casos, esperamos que os erros sejam não correlacionados.</li>
<li class="fragment"><span style="color:red;">Erros autocorrelacionados podem indicar má especificação no modelos de regressão.</span></li>
</ul>
<div class="fragment">
<p>Suponha a seguinte situação:</p>
<ul>
<li class="fragment">Modelo correto: <span class="math inline">\(y_t = \beta_0 + \beta_1 x_t + \beta_2 y_{t-1} + u_t\)</span>.</li>
<li class="fragment">Modelo má especificado <span class="math inline">\(y_t = \beta_0 + \beta_1 x_t + \nu_t\)</span></li>
<li class="fragment">Então <span class="math inline">\(\nu_t = \beta_2 y_{t-1} + u_t\)</span> é autocorrelacionado</li>
</ul>
</div>
</section>
<section id="mqo-e-erros-correlacionados" class="slide level2">
<h2>MQO e erros correlacionados</h2>
<ul>
<li class="fragment">Se <span class="math inline">\(\textbf{X}\)</span> não contem variáveis defasadas de <span class="math inline">\(Y\)</span>, <span class="math inline">\(\hat{\beta}\)</span> é não viesado mas <span class="math inline">\(\mathbb{V}(\beta|X) \neq \sigma^2 (X'X)^{-1}\)</span> (afetando os testes de hipóteses e intervalos de confiança).</li>
<li class="fragment">Se <span class="math inline">\(\textbf{X}\)</span> contem variáveis defasadas de <span class="math inline">\(Y\)</span>, os resultados podem ser bem diferentes do caso anterior (geralmente teremos que <span class="math inline">\(\hat{\beta}\)</span> não é um estimador consistente para <span class="math inline">\(\beta\)</span>).</li>
</ul>
</section></section>
<section>
<section id="testes-para-detetar-erros-autocorrelacionados" class="title-slide slide level1 center">
<h1>Testes para detetar erros autocorrelacionados</h1>

</section>
<section id="testes-para-detetar-erros-autocorrelacionados-1" class="slide level2">
<h2>Testes para detetar erros autocorrelacionados</h2>
<p>Seja o modelo <span class="math display">\[Y = X\beta + u,\]</span> e suspeitamos que <span class="math inline">\(u_t = \phi u_{t-1} + \epsilon_t\)</span>.</p>
<div class="fragment">
<p>A hipótese nula de erros não correlacionados implica <span class="math display">\[H_0: \phi = 0 \quad vs. \quad H_1: \phi \neq 0\]</span></p>
</div>
<div class="fragment">
<blockquote>
<p><strong>Observação:</strong> o teste é a respeito dos <span class="math inline">\(u\)</span>s (que são não observáveis). Em lugar dos <span class="math inline">\(u\)</span>s temos <span class="math inline">\(\hat{u}\)</span>s e isto gera algumas dificuldades. Sabemos que <span class="math inline">\(\hat{u} = \textbf{M}u\)</span> com <span class="math inline">\(\textbf{M} = I - X'(X'X)^{-1}X\)</span>. Assim, <span class="math inline">\(\mathbb{V}(\hat{u}|X) = \sigma_u^2M\)</span>, ou seja, mesmo quando <span class="math inline">\(H_0\)</span> é verdadeiro, os residuais apresentam algum tipo de autocorrelção.</p>
</blockquote>
</div>
</section>
<section id="teste-t" class="slide level2">
<h2>Teste t</h2>
<ol type="1">
<li class="fragment">Regredir <span class="math inline">\(y\)</span> sob <span class="math inline">\(x_1, \cdots, x_k\)</span>.</li>
<li class="fragment">Obter os resíduais <span class="math inline">\(\hat{u}_1, \cdots, \hat{u}_n\)</span></li>
<li class="fragment">Para testar correlação serial do tipo AR(1), regredimos <span class="math inline">\(\hat{u}_t\)</span> sob <span class="math inline">\(\hat{u}_{t-1}\)</span>. Se o coeficiente associado a <span class="math inline">\(\hat{u}_{t-1}\)</span> for estatísticamente significativo (teste t usual), rejeitamos a hipótese nula de residuos não autocorrelacionados.</li>
</ol>
<div class="fragment">
<blockquote>
<p><strong>Observação:</strong> <span class="math inline">\(\textbf{X}\)</span> na regressão do item 1 não deve contar variáveis defasadas de <span class="math inline">\(Y\)</span>.</p>
</blockquote>
</div>
</section>
<section id="teste-t-1" class="slide level2">
<h2>Teste t</h2>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">R</a></li><li><a href="#tabset-4-2">Python</a></li><li><a href="#tabset-4-3">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="fu">data</span>(phillips, <span class="at">package =</span> <span class="st">'wooldridge'</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a>tsdata <span class="ot">&lt;-</span> <span class="fu">ts</span>(phillips, <span class="at">start =</span> <span class="dv">1948</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>modelo <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(inf <span class="sc">~</span> unem, <span class="at">data =</span> tsdata, <span class="at">end =</span> <span class="dv">1996</span>)</span>
<span id="cb27-6"><a href="#cb27-6"></a>u_hat <span class="ot">&lt;-</span> <span class="fu">resid</span>(modelo)</span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="fu">coeftest</span>(<span class="fu">dynlm</span>(u_hat <span class="sc">~</span> <span class="fu">L</span>(u_hat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept) -0.11340    0.35940 -0.3155    0.7538    
L(u_hat)     0.57297    0.11613  4.9337 1.098e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="im">import</span> wooldridge <span class="im">as</span> woo</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a>phillips <span class="op">=</span> woo.dataWoo(<span class="st">'phillips'</span>) </span>
<span id="cb29-6"><a href="#cb29-6"></a>T <span class="op">=</span> <span class="bu">len</span>(phillips)</span>
<span id="cb29-7"><a href="#cb29-7"></a>date_range <span class="op">=</span> pd.date_range(start <span class="op">=</span> <span class="st">'1948'</span>, periods <span class="op">=</span> T, freq <span class="op">=</span> <span class="st">'Y'</span>)</span>
<span id="cb29-8"><a href="#cb29-8"></a>phillips.index <span class="op">=</span> date_range.year</span>
<span id="cb29-9"><a href="#cb29-9"></a></span>
<span id="cb29-10"><a href="#cb29-10"></a>yt96 <span class="op">=</span> (phillips[<span class="st">'year'</span>] <span class="op">&lt;=</span> <span class="dv">1996</span>)</span>
<span id="cb29-11"><a href="#cb29-11"></a>reg_s <span class="op">=</span> smf.ols(formula<span class="op">=</span> <span class="st">'Q("inf") ~ unem'</span>, data <span class="op">=</span> phillips, subset <span class="op">=</span> yt96) </span>
<span id="cb29-12"><a href="#cb29-12"></a>results_s <span class="op">=</span> reg_s.fit()</span>
<span id="cb29-13"><a href="#cb29-13"></a></span>
<span id="cb29-14"><a href="#cb29-14"></a>phillips[<span class="st">'resid_s'</span>] <span class="op">=</span> results_s.resid</span>
<span id="cb29-15"><a href="#cb29-15"></a>phillips[<span class="st">'resid_s_lag1'</span>] <span class="op">=</span> phillips[<span class="st">'resid_s'</span>].shift(<span class="dv">1</span>)</span>
<span id="cb29-16"><a href="#cb29-16"></a>reg <span class="op">=</span> smf.ols(formula <span class="op">=</span> <span class="st">'resid_s ~ resid_s_lag1'</span>, data <span class="op">=</span> phillips, subset <span class="op">=</span> yt96)</span>
<span id="cb29-17"><a href="#cb29-17"></a>results <span class="op">=</span> reg.fit()</span>
<span id="cb29-18"><a href="#cb29-18"></a></span>
<span id="cb29-19"><a href="#cb29-19"></a>table <span class="op">=</span> pd.DataFrame({<span class="st">'b'</span>: <span class="bu">round</span>(results.params, <span class="dv">4</span>),</span>
<span id="cb29-20"><a href="#cb29-20"></a>                      <span class="st">'se'</span>: <span class="bu">round</span>(results.bse, <span class="dv">4</span>),</span>
<span id="cb29-21"><a href="#cb29-21"></a>                      <span class="st">'t'</span>: <span class="bu">round</span>(results.tvalues, <span class="dv">4</span>), </span>
<span id="cb29-22"><a href="#cb29-22"></a>                      <span class="st">'pval'</span>: <span class="bu">round</span>(results.pvalues, <span class="dv">4</span>)})</span>
<span id="cb29-23"><a href="#cb29-23"></a></span>
<span id="cb29-24"><a href="#cb29-24"></a>table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   b      se       t    pval
Intercept    -0.1134  0.3594 -0.3155  0.7538
resid_s_lag1  0.5730  0.1161  4.9337  0.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1"></a><span class="im">using</span> <span class="bu">WooldridgeDatasets</span>, <span class="bu">GLM</span>, <span class="bu">DataFrames</span></span>
<span id="cb31-2"><a href="#cb31-2"></a></span>
<span id="cb31-3"><a href="#cb31-3"></a>phillips <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">wooldridge</span>(<span class="st">"phillips"</span>));</span>
<span id="cb31-4"><a href="#cb31-4"></a>yt96 <span class="op">=</span> <span class="fu">subset</span>(phillips, <span class="op">:</span>year <span class="op">=&gt;</span> <span class="fu">ByRow</span>(<span class="op">&lt;=</span>(<span class="fl">1996</span>)));</span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a>reg_s <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(inf <span class="op">~</span> unem), yt96);</span>
<span id="cb31-7"><a href="#cb31-7"></a>yt96.resid_s <span class="op">=</span> <span class="fu">residuals</span>(reg_s);</span>
<span id="cb31-8"><a href="#cb31-8"></a>yt96.resid_s_lag1 <span class="op">=</span> <span class="fu">lag</span>(yt96.resid_s, <span class="fl">1</span>);</span>
<span id="cb31-9"><a href="#cb31-9"></a></span>
<span id="cb31-10"><a href="#cb31-10"></a>reg <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(resid_s <span class="op">~</span> resid_s_lag1), yt96);</span>
<span id="cb31-11"><a href="#cb31-11"></a><span class="fu">coeftable</span>(reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>──────────────────────────────────────────────────────────────────────────
                  Coef.  Std. Error      t  Pr(&gt;|t|)  Lower 95%  Upper 95%
──────────────────────────────────────────────────────────────────────────
(Intercept)   -0.113397    0.359404  -0.32    0.7538  -0.836839   0.610046
resid_s_lag1   0.572969    0.116133   4.93    &lt;1e-4    0.339205   0.806734
──────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="teste-de-durbin-watson" class="slide level2">
<h2>Teste de Durbin-Watson</h2>
<center>
Teste de correlação serial do tipo AR(1).
</center>
<ul>
<li class="fragment"><span class="math inline">\(H_0:\)</span> os erros são não correlacionados.</li>
<li class="fragment">Estatística de teste: <span class="math inline">\(DW = \displaystyle \sum_{t = 2}^n (\hat{u}_t - \hat{u}_{t-1})^2 \Big / \displaystyle \sum_{t = 1}^n \hat{u}_t^2 \approx 2(1 - \hat{\phi})\)</span></li>
<li class="fragment">Intuitivamente:</li>
</ul>
<div class="fragment">
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Estatística</th>
<th style="text-align: center;">Decisão</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">DW &lt; 2</td>
<td style="text-align: center;">autocorrelação positiva</td>
</tr>
<tr class="even">
<td style="text-align: center;">DW &gt; 2</td>
<td style="text-align: center;">autocorrelação negativa</td>
</tr>
<tr class="odd">
<td style="text-align: center;">DW <span class="math inline">\(\approx\)</span> 0</td>
<td style="text-align: center;">autocorrelação zero</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="teste-de-durbin-watson-1" class="slide level2">
<h2>Teste de Durbin-Watson</h2>
<ul>
<li class="fragment">Se DW &lt; 2, estamos interessados em saber se o valor obtido é suficiente para rejeitar <span class="math inline">\(H_0\)</span> em favor de <span class="math inline">\(H_1: \rho &gt; 0\)</span>.</li>
<li class="fragment">Durbin-Watson derivam a distribuição de DW, mas esta depende dos valores de <span class="math inline">\(\textbf{X}\)</span>, tamanho amostral <span class="math inline">\(n\)</span>, número <span class="math inline">\(k\)</span> de variáveis do modelo, etc.</li>
<li class="fragment">Regra de decisão:
<ul>
<li class="fragment"><span class="math inline">\(DW &lt; d_L\)</span> rejeitamos <span class="math inline">\(H_0\)</span>.</li>
<li class="fragment"><span class="math inline">\(DW &gt; d_U\)</span> não rejeitamos <span class="math inline">\(H_0\)</span>.</li>
<li class="fragment"><span class="math inline">\(d_L &lt; DW &lt; d_U\)</span> inconclussivo</li>
</ul></li>
</ul>
<div class="fragment">
<blockquote>
<p>Se <span class="math inline">\(DW &gt; 2\)</span>, podemos estar interessados em testar <span class="math inline">\(H_1: \rho &lt; 0\)</span>. Neste caso, calculamos 4-d e comparamos esta estatística com os valores criticos tabulados <span class="math inline">\(d_L\)</span> e <span class="math inline">\(d_U\)</span> vistos anteriormente.</p>
</blockquote>
</div>
</section>
<section id="teste-de-durbin-watson-2" class="slide level2">
<h2>Teste de Durbin-Watson</h2>
<div class="panel-tabset">
<ul id="tabset-5" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-5-1">R</a></li><li><a href="#tabset-5-2">Python</a></li><li><a href="#tabset-5-3">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="fu">data</span>(phillips, <span class="at">package =</span> <span class="st">'wooldridge'</span>)</span>
<span id="cb33-4"><a href="#cb33-4"></a>tsdata <span class="ot">&lt;-</span> <span class="fu">ts</span>(phillips, <span class="at">start =</span> <span class="dv">1948</span>)</span>
<span id="cb33-5"><a href="#cb33-5"></a>reg.s <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(inf <span class="sc">~</span> unem, <span class="at">data =</span> tsdata, <span class="at">end =</span> <span class="dv">1996</span>)</span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="fu">dwtest</span>(reg.s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Durbin-Watson test

data:  reg.s
DW = 0.8027, p-value = 7.552e-07
alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="im">import</span> wooldridge <span class="im">as</span> woo</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a>phillips <span class="op">=</span> woo.dataWoo(<span class="st">'phillips'</span>) </span>
<span id="cb35-7"><a href="#cb35-7"></a>T <span class="op">=</span> <span class="bu">len</span>(phillips)</span>
<span id="cb35-8"><a href="#cb35-8"></a></span>
<span id="cb35-9"><a href="#cb35-9"></a>date_range <span class="op">=</span> pd.date_range(start <span class="op">=</span> <span class="st">'1948'</span>, periods <span class="op">=</span> T, freq <span class="op">=</span> <span class="st">'Y'</span>) </span>
<span id="cb35-10"><a href="#cb35-10"></a>phillips.index <span class="op">=</span> date_range.year</span>
<span id="cb35-11"><a href="#cb35-11"></a></span>
<span id="cb35-12"><a href="#cb35-12"></a>yt96 <span class="op">=</span> (phillips[<span class="st">'year'</span>] <span class="op">&lt;=</span> <span class="dv">1996</span>)</span>
<span id="cb35-13"><a href="#cb35-13"></a>phillips[<span class="st">'inf_diff1'</span>] <span class="op">=</span> phillips[<span class="st">'inf'</span>].diff()</span>
<span id="cb35-14"><a href="#cb35-14"></a>reg_s <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">'Q("inf") ~ unem'</span>, data <span class="op">=</span> phillips, subset <span class="op">=</span> yt96)</span>
<span id="cb35-15"><a href="#cb35-15"></a></span>
<span id="cb35-16"><a href="#cb35-16"></a>results_s <span class="op">=</span> reg_s.fit()</span>
<span id="cb35-17"><a href="#cb35-17"></a>DW_s <span class="op">=</span> sm.stats.stattools.durbin_watson(results_s.resid)</span>
<span id="cb35-18"><a href="#cb35-18"></a>DW_s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.802700467848626</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource julia number-lines code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1"></a><span class="im">using</span> <span class="bu">WooldridgeDatasets</span>, <span class="bu">GLM</span>, <span class="bu">DataFrames</span>, <span class="bu">HypothesisTests</span>, <span class="bu">StatsModels</span></span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>phillips <span class="op">=</span> <span class="fu">DataFrame</span>(<span class="fu">wooldridge</span>(<span class="st">"phillips"</span>));</span>
<span id="cb37-4"><a href="#cb37-4"></a>yt96 <span class="op">=</span> <span class="fu">subset</span>(phillips, <span class="op">:</span>year <span class="op">=&gt;</span> <span class="fu">ByRow</span>(<span class="op">&lt;=</span>(<span class="fl">1996</span>)));</span>
<span id="cb37-5"><a href="#cb37-5"></a></span>
<span id="cb37-6"><a href="#cb37-6"></a>reg_s <span class="op">=</span> <span class="fu">lm</span>(<span class="pp">@formula</span>(inf <span class="op">~</span> unem), yt96);</span>
<span id="cb37-7"><a href="#cb37-7"></a>X_s <span class="op">=</span> <span class="fu">modelmatrix</span>(reg_s); </span>
<span id="cb37-8"><a href="#cb37-8"></a>resid_s <span class="op">=</span> <span class="fu">residuals</span>(reg_s);</span>
<span id="cb37-9"><a href="#cb37-9"></a></span>
<span id="cb37-10"><a href="#cb37-10"></a>DW_s <span class="op">=</span> <span class="fu">DurbinWatsonTest</span>(X_s, resid_s);</span>
<span id="cb37-11"><a href="#cb37-11"></a>DW_s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Durbin-Watson autocorrelation test
----------------------------------
Population details:
    parameter of interest:   sample autocorrelation parameter
    value under h_0:         "0"
    point estimate:          0.59865

Test summary:
    outcome with 95% confidence: reject h_0
    two-sided p-value:           &lt;1e-5

Details:
    number of observations:     49
    DW statistic:               0.8027</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="teste-de-durbin-watson-3" class="slide level2">
<h2>Teste de Durbin-Watson</h2>
<h4 id="observações">Observações:</h4>
<ul>
<li class="fragment">Para aplicar o teste de Durbin-Watson é necessário que o intercepto seja incluido na regressão. Quando o intercepto não é incluido, <span class="math inline">\(d_U\)</span> continua válido mas <span class="math inline">\(d_L\)</span> precisa ser subtituido por <span class="math inline">\(d_M\)</span>.</li>
<li class="fragment">Para aplicar o teste de Durbin-Watson <span class="math inline">\(\textbf{X}\)</span> não deve conter valores defasados de <span class="math inline">\(Y\)</span>. Se valores defasados de <span class="math inline">\(Y\)</span> são incluidos em <span class="math inline">\(\textbf{X}\)</span>, a estatística DW é viesada e levara a conclusões enganosas. Uma alternativa nestas situações é a seguinte:
<ul>
<li class="fragment">Ajustar por MQO a regressão de <span class="math inline">\(y_t\)</span> sob <span class="math inline">\(x_{1t}, \cdots, x_{kt}\)</span> e obter os resíduos <span class="math inline">\(\hat{u}_t\)</span>.</li>
<li class="fragment">Ajustar por MQO a regressão de <span class="math inline">\(\hat{u}_t\)</span> sob <span class="math inline">\(\hat{u}_{t-1}\)</span>, <span class="math inline">\(x_{1t}, \cdots, x_{kt}\)</span></li>
<li class="fragment">Se o coeficiente da regresseão associado a <span class="math inline">\(\hat{u}_{t-1}\)</span> for estatísticamente significativo (utilizando um teste t usual), rejetimaos a hipótese nula de que os erros são não correlacionados.</li>
</ul></li>
</ul>
</section>
<section id="teste-para-ordens-maiores" class="slide level2">
<h2>Teste para ordens maiores</h2>
<p>Até agora temos assumido o modelo <span class="math display">\[Y = X\beta + u,\]</span> e suspeitams que <span class="math inline">\(u_t = \phi u_{t-1} + \epsilon_t\)</span>.</p>
<div class="fragment">
<p>Em geral, podemos suspeitar que <span class="math inline">\(u_t = \phi_1 u_{t-1} + \cdots + \phi_k u_{t-k} + \epsilon_t\)</span>.</p>
</div>
<div class="fragment">
<p>O mesmo procedimento geral utilizado anteriormente pode também ser aplicado:</p>
<ul>
<li class="fragment">Ajustar por MQO a regressão de <span class="math inline">\(y_t\)</span> sob <span class="math inline">\(x_{1t}, \cdots, x_{kt}\)</span> e obter os resíduos <span class="math inline">\(\hat{u}_t\)</span>.</li>
<li class="fragment">Ajustar por MQO a regressão de <span class="math inline">\(\hat{u}_t\)</span> sob <span class="math inline">\(\hat{u}_{t-1}, \cdots, \hat{u}_{t-k}\)</span>, <span class="math inline">\(x_{1t}, \cdots, x_{kt}\)</span></li>
<li class="fragment">Utilizamos um teste F para testar se os coefiencientes associados a <span class="math inline">\(\hat{u}_{t-1}, \cdots, \hat{u}_{t-k}\)</span> são todos nulos. Se rejeitamos <span class="math inline">\(H_0\)</span> do teste F, rejeitamos a hipótese nula de que os erros são não correlacionados.</li>
</ul>
</div>
<div class="fragment">
<blockquote>
<p><strong>Obs:</strong> o teste requer homocedasticidade. No caso de heterocedasticidade, um correção pode ser feita como discutido na seção de heterocedasticidade.</p>
</blockquote>
</div>
</section>
<section id="o-que-fazer-se-os-erros-são-autocorrelacionados" class="slide level2">
<h2>O que fazer se os erros são autocorrelacionados?</h2>
<ul>
<li class="fragment">Precisamos estimar corretamente <span class="math inline">\(\mathbb{V}(\beta | X)\)</span>.</li>
<li class="fragment">Assim como utilizamos o estimador de White no caso de heterocedasticidade, utilizaremos outro estimador que seja robusto a correlação serial.</li>
<li class="fragment">O estimador HAC (heteroskedasticity and autocorrelation consistent) será utilizado.</li>
</ul>
</section>
<section id="o-que-fazer-se-os-erros-são-autocorrelacionados-1" class="slide level2">
<h2>O que fazer se os erros são autocorrelacionados?</h2>
<div class="panel-tabset">
<ul id="tabset-6" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-6-1">R</a></li><li><a href="#tabset-6-2">Python</a></li><li><a href="#tabset-6-3">Julia</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">library</span>(dynlm)</span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb39-4"><a href="#cb39-4"></a></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="fu">data</span>(prminwge, <span class="at">package =</span> <span class="st">'wooldridge'</span>)</span>
<span id="cb39-6"><a href="#cb39-6"></a>tsdata <span class="ot">&lt;-</span> <span class="fu">ts</span>(prminwge, <span class="at">start =</span> <span class="dv">1950</span>)</span>
<span id="cb39-7"><a href="#cb39-7"></a>reg <span class="ot">&lt;-</span> <span class="fu">dynlm</span>(<span class="fu">log</span>(prepop) <span class="sc">~</span> <span class="fu">log</span>(mincov) <span class="sc">+</span> <span class="fu">log</span>(prgnp) <span class="sc">+</span> <span class="fu">log</span>(usgnp) <span class="sc">+</span> <span class="fu">trend</span>(tsdata), <span class="at">data =</span> tsdata)</span>
<span id="cb39-8"><a href="#cb39-8"></a></span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="fu">coeftest</span>(reg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

                Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)   -6.6634416  1.2578286 -5.2976 7.667e-06 ***
log(mincov)   -0.2122612  0.0401523 -5.2864 7.924e-06 ***
log(prgnp)     0.2852380  0.0804921  3.5437  0.001203 ** 
log(usgnp)     0.4860483  0.2219825  2.1896  0.035731 *  
trend(tsdata) -0.0266633  0.0046267 -5.7629 1.940e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">NeweyWest</span>(reg, <span class="at">lag =</span> <span class="dv">2</span>, <span class="at">prewhite =</span> <span class="cn">FALSE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)   log(mincov)    log(prgnp)    log(usgnp) trend(tsdata) 
   1.43178840    0.04260481    0.09284990    0.26010232    0.00536379 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># coeftest(reg, vcovHAC) (Qual o valor de g?)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-6-2">
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a><span class="im">import</span> wooldridge <span class="im">as</span> woo</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb44-5"><a href="#cb44-5"></a></span>
<span id="cb44-6"><a href="#cb44-6"></a>prminwge <span class="op">=</span> woo.dataWoo(<span class="st">'prminwge'</span>)</span>
<span id="cb44-7"><a href="#cb44-7"></a>T <span class="op">=</span> <span class="bu">len</span>(prminwge)</span>
<span id="cb44-8"><a href="#cb44-8"></a>prminwge[<span class="st">'time'</span>] <span class="op">=</span> prminwge[<span class="st">'year'</span>] <span class="op">-</span> <span class="dv">1949</span></span>
<span id="cb44-9"><a href="#cb44-9"></a>prminwge.index <span class="op">=</span> pd.date_range(start <span class="op">=</span> <span class="st">'1950'</span>, periods <span class="op">=</span> T, freq <span class="op">=</span> <span class="st">'Y'</span>).year</span>
<span id="cb44-10"><a href="#cb44-10"></a></span>
<span id="cb44-11"><a href="#cb44-11"></a>reg <span class="op">=</span> smf.ols(formula<span class="op">=</span><span class="st">'np.log(prepop) ~ np.log(mincov) + np.log(prgnp) + np.log(usgnp) + time'</span>, data <span class="op">=</span> prminwge)</span>
<span id="cb44-12"><a href="#cb44-12"></a>results_regu <span class="op">=</span> reg.fit()</span>
<span id="cb44-13"><a href="#cb44-13"></a></span>
<span id="cb44-14"><a href="#cb44-14"></a>table_regu <span class="op">=</span> pd.DataFrame({<span class="st">'b'</span>: <span class="bu">round</span>(results_regu.params, <span class="dv">4</span>),</span>
<span id="cb44-15"><a href="#cb44-15"></a>                          <span class="st">'se'</span>: <span class="bu">round</span>(results_regu.bse, <span class="dv">4</span>),</span>
<span id="cb44-16"><a href="#cb44-16"></a>                          <span class="st">'t'</span>: <span class="bu">round</span>(results_regu.tvalues, <span class="dv">4</span>),</span>
<span id="cb44-17"><a href="#cb44-17"></a>                          <span class="st">'pval'</span>: <span class="bu">round</span>(results_regu.pvalues, <span class="dv">4</span>)})</span>
<span id="cb44-18"><a href="#cb44-18"></a></span>
<span id="cb44-19"><a href="#cb44-19"></a>results_hac <span class="op">=</span> reg.fit(cov_type <span class="op">=</span> <span class="st">'HAC'</span>, cov_kwds<span class="op">=</span>{<span class="st">'maxlags'</span>: <span class="dv">2</span>})</span>
<span id="cb44-20"><a href="#cb44-20"></a>table_hac <span class="op">=</span> pd.DataFrame({<span class="st">'b'</span>: <span class="bu">round</span>(results_hac.params, <span class="dv">4</span>),</span>
<span id="cb44-21"><a href="#cb44-21"></a>                          <span class="st">'se'</span>: <span class="bu">round</span>(results_hac.bse, <span class="dv">4</span>),</span>
<span id="cb44-22"><a href="#cb44-22"></a>                          <span class="st">'t'</span>: <span class="bu">round</span>(results_hac.tvalues, <span class="dv">4</span>), </span>
<span id="cb44-23"><a href="#cb44-23"></a>                          <span class="st">'pval'</span>: <span class="bu">round</span>(results_hac.pvalues, <span class="dv">4</span>)})</span>
<span id="cb44-24"><a href="#cb44-24"></a>                          </span>
<span id="cb44-25"><a href="#cb44-25"></a>table_regu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     b      se       t    pval
Intercept      -6.6634  1.2578 -5.2976  0.0000
np.log(mincov) -0.2123  0.0402 -5.2864  0.0000
np.log(prgnp)   0.2852  0.0805  3.5437  0.0012
np.log(usgnp)   0.4860  0.2220  2.1896  0.0357
time           -0.0267  0.0046 -5.7629  0.0000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>table_hac</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     b      se       t    pval
Intercept      -6.6634  1.4318 -4.6539  0.0000
np.log(mincov) -0.2123  0.0426 -4.9821  0.0000
np.log(prgnp)   0.2852  0.0928  3.0720  0.0021
np.log(usgnp)   0.4860  0.2601  1.8687  0.0617
time           -0.0267  0.0054 -4.9710  0.0000</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3">
<p>Implementar (ver lista)</p>
</div>
</div>
</div>
</section>
<section id="o-que-fazer-se-os-erros-são-autocorrelacionados-2" class="slide level2">
<h2>O que fazer se os erros são autocorrelacionados?</h2>
<ol type="1">
<li class="fragment">Ajustar o modelo <span class="math inline">\(y_t = \beta_0 + \beta_1 x_{1t} + \cdots, \beta_k x_{kt} + u_t\)</span></li>
<li class="fragment">Ajustar o modelo auxiliar <span class="math inline">\(x_{1t} = \delta_0 + delta_2 x_{2t} + \cdots + \delta_k x_{kt} + r_t\)</span></li>
<li class="fragment">Calcular <span class="math inline">\(\hat{a}_t = \hat{r}_t \hat{u}_t\)</span></li>
<li class="fragment">Calcular <span class="math inline">\(\hat{\nu} = \displaystyle \sum_{t=1}^n \hat{a}_t^2 + 2 \sum_{h= 1}^g [1 - h/(g+1)](\sum_{t = h + 1}^n \hat{a}_t \hat{a}_{t-h})\)</span></li>
<li class="fragment">O novo desvio padrão será dado por <span class="math display">\[[\sqrt{\mathbb{V}(\hat{\beta}_1|X)}/\hat{\sigma}]^2 \sqrt{\hat{\nu}}\]</span></li>
</ol>
<div class="fragment">
<blockquote>
<p>O mesmo pode ser feito para i = 2, 3, …, k.</p>
</blockquote>
<p><img src="imagens/imecc.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>Carlos Trucíos (IMECC/UNICAMP) | ME715 - Econometria | <a href="https://ctruciosm.github.io/">ctruciosm.github.io</a></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="ME715_Aula06_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="ME715_Aula06_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="ME715_Aula06_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="ME715_Aula06_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="ME715_Aula06_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="ME715_Aula06_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="ME715_Aula06_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="ME715_Aula06_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="ME715_Aula06_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="ME715_Aula06_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="ME715_Aula06_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'print',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>